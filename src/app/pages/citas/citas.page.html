<ion-header>
  <ion-toolbar color="primary">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/home"></ion-back-button>
    </ion-buttons>
    <ion-title>Gestión de Citas</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <!-- Formulario para agregar citas -->
  <ion-card>
    <ion-card-header>
      <ion-card-title>Agregar Nueva Cita</ion-card-title>
    </ion-card-header>
    
    <ion-card-content>
      <form [formGroup]="citaForm" (ngSubmit)="agregarCita()">
        <ion-item>
          <ion-label position="floating">Frase *</ion-label>
          <ion-textarea 
            formControlName="frase" 
            rows="3"
            placeholder="Ingresa la cita famosa">
          </ion-textarea>
        </ion-item>
        
        <div *ngIf="frase.invalid && (frase.dirty || frase.touched)" class="error-message">
          <ion-text color="danger" *ngIf="frase.errors?.['required']">
            La frase es obligatoria
          </ion-text>
          <ion-text color="danger" *ngIf="frase.errors?.['minlength']">
            La frase debe tener al menos 5 caracteres
          </ion-text>
        </div>
        
        <ion-item>
          <ion-label position="floating">Autor *</ion-label>
          <ion-input 
            formControlName="autor" 
            type="text"
            placeholder="Nombre del autor">
          </ion-input>
        </ion-item>
        
        <div *ngIf="autor.invalid && (autor.dirty || autor.touched)" class="error-message">
          <ion-text color="danger" *ngIf="autor.errors?.['required']">
            El autor es obligatorio
          </ion-text>
          <ion-text color="danger" *ngIf="autor.errors?.['minlength']">
            El autor debe tener al menos 2 caracteres
          </ion-text>
        </div>
        
        <ion-button 
          expand="block" 
          type="submit" 
          [disabled]="!citaForm.valid"
          class="ion-margin-top">
          <ion-icon slot="start" name="add"></ion-icon>
          Agregar Cita
        </ion-button>
      </form>
    </ion-card-content>
  </ion-card>
  
  <!-- Lista de citas existentes -->
  <ion-card>
    <ion-card-header>
      <ion-card-title>Citas Registradas ({{citas.length}})</ion-card-title>
    </ion-card-header>
    
    <ion-card-content>
      <ion-list>
        <ion-item-sliding *ngFor="let cita of citas">
          <ion-item>
            <ion-label>
              <h2>"{{cita.frase}}"</h2>
              <p>- {{cita.autor}}</p>
              <p class="fecha">{{cita.fechaCreacion | date:'dd/MM/yyyy'}}</p>
            </ion-label>
          </ion-item>
          
          <ion-item-options side="end">
            <ion-item-option color="danger" (click)="eliminarCita(cita.id)">
              <ion-icon slot="icon-only" name="trash"></ion-icon>
            </ion-item-option>
          </ion-item-options>
        </ion-item-sliding>
        
        <ion-item *ngIf="citas.length === 0">
          <ion-label class="ion-text-center">
            <h3>No hay citas registradas</h3>
            <p>Agrega tu primera cita usando el formulario superior</p>
          </ion-label>
        </ion-item>
      </ion-list>
    </ion-card-content>
  </ion-card>
</ion-content>
